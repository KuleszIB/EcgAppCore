#include "r_peaks0.h"
#include "sigpack.h"

R_Peaks::R_Peaks()
{
    signal_raw = {-0.098852,-0.13624,-0.1468,-0.13788,-0.12564,-0.11906,-0.11536,-0.10913,-0.10145,-0.098269,-0.10186,-0.10745,-0.10962,-0.10926,-0.11154,-0.11754,-0.12083,-0.11485,-0.10222,-0.093804,-0.097051,-0.10645,-0.10784,-0.093148,-0.070043,-0.056286,-0.064076,-0.089173,-0.11585,-0.1308,-0.13298,-0.13165,-0.1358,-0.1459,-0.15438,-0.15346,-0.14225,-0.12787,-0.11976,-0.12215,-0.13094,-0.13757,-0.13662,-0.13016,-0.12482,-0.12442,-0.12573,-0.12201,-0.11075,-0.097241,-0.089881,-0.092074,-0.099279,-0.10364,-0.101,-0.093474,-0.08623,-0.08363,-0.087626,-0.098075,-0.11248,-0.1262,-0.1358,-0.14345,-0.15683,-0.18156,-0.2121,-0.23101,-0.21881,-0.16591,-0.075119,0.046938,0.19948,0.38655,0.60303,0.81903,0.9775,1.013,0.88543,0.60928,0.25832,-0.063829,-0.27288,-0.34338,-0.31248,-0.24749,-0.2018,-0.19036,-0.19651,-0.19731,-0.18388,-0.1637,-0.14921,-0.14618,-0.15091,-0.15554,-0.15501,-0.1499,-0.14406,-0.13998,-0.13637,-0.13032,-0.12145,-0.11374,-0.11239,-0.11796,-0.12408,-0.12196,-0.10841,-0.089639,-0.07645,-0.075022,-0.082042,-0.088821,-0.090048,-0.088081,-0.088642,-0.093188,-0.096312,-0.091577,-0.078998,-0.066112,-0.060926,-0.06417,-0.068807,-0.067201,-0.058627,-0.049511,-0.046534,-0.050034,-0.054328,-0.054046,-0.049844,-0.047425,-0.051167,-0.05893,-0.063371,-0.058686,-0.046146,-0.033349,-0.027722,-0.030335,-0.035758,-0.03757,-0.034335,-0.030435,-0.031237,-0.037317,-0.043442,-0.043373,-0.035904,-0.026435,-0.022294,-0.026135,-0.033334,-0.036157,-0.030959,-0.021793,-0.016873,-0.020964,-0.030771,-0.037664,-0.035517,-0.026367,-0.01856,-0.018927,-0.026669,-0.034741,-0.03709,-0.034626,-0.033493,-0.037811,-0.044539,-0.046307,-0.039429,-0.028644,-0.022967,-0.026749,-0.034961,-0.038242,-0.03249,-0.023033,-0.018827,-0.022672,-0.027693,-0.024188,-0.0098148,0.007492,0.016747,0.014386,0.0076141,0.0074486,0.018412,0.034651,0.045659,0.04617,0.040796,0.039394,0.047647,0.0619,0.072858,0.074322,0.068775,0.064317,0.066508,0.073176,0.077187,0.073761,0.065,0.057194,0.054566,0.055839,0.056655,0.054348,0.05003,0.046477,0.044661,0.042818,0.038718,0.032544,0.027168,0.025484,0.027046,0.027815,0.023601,0.01457,0.006179,0.0046706,0.010917,0.018739,0.020254,0.01345,0.0044976,0.0017673,0.007624,0.015842,0.017854,0.011251,0.0019413,-0.002052,0.0013356,0.006361,0.0056918,-0.0022679,-0.012057,-0.016973,-0.015783,-0.013343,-0.014883,-0.020008,-0.022804,-0.01797,-0.0067466,0.0033085,0.0049511,-0.0020627,-0.010615,-0.013019,-0.0083616,-0.0035706,-0.0062968,-0.016786,-0.026659,-0.026796,-0.016706,-0.0058498,-0.0049813,-0.015692,-0.028474,-0.031634,-0.022429,-0.0094819,-0.0045925,-0.011845,-0.024446,-0.031462,-0.02752,-0.016622,-0.0073231,-0.0047753,-0.0069409,-0.0077157,-0.003622,0.0027896,0.0058245,0.0027096,-0.00299,-0.0045669,0.0011185,0.0098255,0.013417,0.0074865,-0.0039736,-0.011686,-0.0090632,0.0023339,0.014874,0.021918,0.02306,0.022871,0.025473,0.031022,0.037018,0.042298,0.048671,0.05849,0.070883,0.081052,0.083548,0.076682,0.064235,0.052962,0.048014,0.049257,0.051429,0.048423,0.039008,0.028936,0.026848,0.03598,0.049547,0.054898,0.043641,0.018658,-0.0088712,-0.029347,-0.041448,-0.04969,-0.05686,-0.06053,-0.057125,-0.048284,-0.041398,-0.042813,-0.051586,-0.060502,-0.063458,-0.061175,-0.059194,-0.060849,-0.06296,-0.05955,-0.049043,-0.037352,-0.032817,-0.038065,-0.047087,-0.05056,-0.044278,-0.032911,-0.025822,-0.029188,-0.041374,-0.055485,-0.066661,-0.077535,-0.096328,-0.12813,-0.16666,-0.19475,-0.19402,-0.15526,-0.079907,0.027668,0.16775,0.34356,0.55162,0.77324,0.9747,1.1149,1.1558,1.074,0.87226,0.5859,0.27553,0.0041256,-0.18861,-0.29695,-0.33934,-0.33969,-0.31631,-0.28251,-0.25011,-0.2276,-0.21604,-0.20987,-0.20372,-0.19718,-0.19249,-0.18913,-0.18351,-0.17438,-0.16607,-0.16447,-0.16966,-0.17454,-0.17188,-0.16176,-0.15091,-0.14467,-0.14128,-0.13486,-0.12351,-0.113,-0.11099,-0.11839,-0.12729,-0.12799,-0.11812,-0.10473,-0.097244,-0.098926,-0.10467,-0.10691,-0.10292,-0.096579,-0.093448,-0.094597,-0.095441,-0.090586,-0.079806,-0.06888,-0.06441,-0.067319,-0.071493,-0.069351,-0.059397,-0.048182,-0.044508,-0.050743,-0.059792,-0.061284,-0.051499,-0.037422,-0.030539,-0.035963,-0.047434,-0.053149,-0.047151,-0.035001,-0.028277,-0.033298,-0.045065,-0.05252,-0.049297,-0.039582,-0.033454,-0.036781,-0.045822,-0.051637,-0.049325,-0.042668,-0.039774,-0.044485,-0.052348,-0.055456,-0.050793,-0.043671,-0.042551,-0.050351,-0.061042,-0.065406,-0.06004,-0.05099,-0.04782,-0.054171,-0.064058,-0.06778,-0.061646,-0.051639,-0.047439,-0.05266,-0.061154,-0.062862,-0.053585,-0.039205,-0.028786,-0.026036,-0.02542,-0.017764,0.00050322,0.023586,0.041524,0.048882,0.04922,0.051569,0.062169,0.078181,0.089021,0.085662,0.070741,0.059204,0.065339,0.086443,0.101,0.088357,0.054225,0.034731,0.068989,0.16246};
}

void R_Peaks::pan_tompkins()
{

}
void R_Peaks::filter_bandpass()
{

}
void R_Peaks::filter_lowpass()
{

}
void R_Peaks::filter_highpass()
{
    double fc = 5 / (sampling_frequency / 2);
    int M = 30;
    arma::vec coeffs = sp::fir1_hp(M, fc);
}
void R_Peaks::differentiate()
{

}
void R_Peaks::square()
{

}
void R_Peaks::integrate()
{

}
void R_Peaks::hilbert_transform()
{

}

void R_Peaks::find_r_peaks(R_Detection_Method method)
{
    switch(method)
    {
    case PAN_TOMPKINS:
        pan_tompkins();
        break;

    case HILBERT_TRANSFORM:
        hilbert_transform();
        break;

    default:
        pan_tompkins();
        break;
    }
}

arma::vec R_Peaks::get_r_peaks()
{
   return r_peaks_vec;
}
